<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dino Runner Improved</title>
<style>
  body {
    margin: 0;
    padding: 0;
    font-family: Arial, sans-serif;
    background: #f7f7f7;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    overflow: hidden;
  }

  #game {
    width: 800px;
    height: 200px;
    background: #e0f7fa;
    border: 3px solid #333;
    position: relative;
    overflow: hidden;
  }

  #dino {
    width: 60px;
    height: 60px;
    position: absolute;
    bottom: 0;
    left: 50px;
    background: url("/images/pinguino.png") no-repeat center/contain;
  }

  .cactus {
    width: 40px;
    height: 60px;
    position: absolute;
    bottom: 0;
    right: -40px;
    background: url("/images/cactus.png") no-repeat center/contain;
  }

  #score {
    position: absolute;
    top: 10px;
    left: 10px;
    font-size: 18px;
    font-weight: bold;
  }

  #game-over {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 28px;
    color: red;
    display: none;
    text-align: center;
  }
</style>
</head>
<body>
<div id="game">
  <div id="dino"></div>
  <div id="score">Score: 0</div>
  <div id="game-over">Game Over!<br>Press SPACE or TAP to restart</div>
</div>

<script>
const game = document.getElementById("game");
const dino = document.getElementById("dino");
const scoreDisplay = document.getElementById("score");
const gameOverText = document.getElementById("game-over");

let isJumping = false;
let velocity = 0;
let gravity = 0.8;
let position = 0;
let score = 0;
let gameOver = false;
let cactusSpeed = 6;
let obstacles = [];

function jump() {
  if (!isJumping && !gameOver) {
    isJumping = true;
    velocity = -12;
  } else if (gameOver) {
    restartGame();
  }
}

document.addEventListener("keydown", e => { if (e.code === "Space") jump(); });
document.addEventListener("click", jump);
document.addEventListener("touchstart", jump);

function createCactus() {
  const cactus = document.createElement("div");
  cactus.classList.add("cactus");
  game.appendChild(cactus);
  obstacles.push(cactus);
  cactus.style.right = "-40px";
}

setInterval(() => {
  if (!gameOver) {
    score++;
    scoreDisplay.textContent = "Score: " + score;
    if(score % 50 === 0) cactusSpeed += 0.5; // increase difficulty
  }
}, 200);

function updateGame() {
  // Dino physics
  velocity += gravity;
  position += velocity;
  if(position <= 0){
    position = 0;
    isJumping = false;
    velocity = 0;
  }
  dino.style.bottom = position + "px";

  // Move obstacles
  obstacles.forEach((cactus, index) => {
    let right = parseFloat(cactus.style.right);
    right += cactusSpeed;
    cactus.style.right = right + "px";

    // Remove off-screen cactus
    if (right > 850) {
      cactus.remove();
      obstacles.splice(index, 1);
    }

    // Collision detection
    const dinoRect = dino.getBoundingClientRect();
    const cactusRect = cactus.getBoundingClientRect();
    if (
      dinoRect.right > cactusRect.left &&
      dinoRect.left < cactusRect.right &&
      dinoRect.bottom > cactusRect.top
    ) {
      gameOver = true;
      gameOverText.style.display = "block";
    }
  });

  if (!gameOver) requestAnimationFrame(updateGame);
}

function spawnObstacles() {
  if(!gameOver){
    createCactus();
    setTimeout(spawnObstacles, 1500 + Math.random() * 2000);
  }
}

function restartGame() {
  score = 0;
  cactusSpeed = 6;
  gameOver = false;
  gameOverText.style.display = "none";
  obstacles.forEach(c => c.remove());
  obstacles = [];
  position = 0;
  velocity = 0;
  updateGame();
  spawnObstacles();
}

updateGame();
spawnObstacles();
</script>
</body>
</html>
